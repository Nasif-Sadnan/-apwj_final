<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Super Shop Inventory</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
 <style>
:root {
  --bg-light: #f0f8ff;
  --bg-dark: #1c1c2b;
  --card-light: #fff;
  --card-dark: #2a2a3d;
  --text-light: #333;
  --text-dark: #eee;
  --accent: #09b9ff;   
  --hover: #10a2fd;    
}

  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg-light);
    color: var(--text-light);
    margin: 0;
    padding: 20px;
    transition: all 0.3s ease;
  }

  h1, h2 {
    color: var(--accent);
  }


  form, table, section {
    background-color: var(--card-light);
    padding: 20px;
    margin-top: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    transition: all 0.3s ease;
  }


form {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: flex-start;
}

form input,
form select,
form button {
  flex: 1 1 200px;
  min-width: 150px;
}

section {
  margin-top: 40px; /* More space between sections */
  padding: 24px;
}

table {
  margin-top: 20px;
}

h2 {
  margin-bottom: 16px;
}

form button {
  margin-top: 10px;
  align-self: flex-end;
}

input[type="date"],
select {
  max-width: 250px;
}

@media (max-width: 600px) {
  form {
    flex-direction: column;
  }

  form input,
  form select,
  form button {
    width: 100%;
  }
}

  input, select, button {
    margin: 5px 8px 10px 0;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 14px;
  }

  button {
    background-color: var(--accent);
    color: white;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  button:hover {
    background-color: var(--hover);
  }

  table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 15px;
    animation: fadeIn 0.5s ease-in;
  }

  th, td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ccc;
  }

  th {
    background-color: #e3f2fd;
  }

  .icon {
    margin-right: 8px;
    color: var(--hover);
  }

  hr {
    border: 0;
    height: 1px;
    background-color: #ccc;
    margin: 30px 0;
  }

  .dark-mode {
    background: var(--bg-dark);
    color: var(--text-dark);
  }

  .dark-mode section, .dark-mode form, .dark-mode table {
    background: var(--card-dark);
    color: var(--text-dark);
  }

  .dark-mode th {
    background-color: #37474f;
    color: #fff;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  #toggleMode {
    float: right;
    background: none;
    border: 2px solid var(--accent);
    border-radius: 20px;
    color: var(--accent);
    padding: 6px 12px;
    font-size: 14px;
    cursor: pointer;
  }

  #toggleMode:hover {
    background: var(--accent);
    color: white;
  }
  </style>
</head>
<body>

  <button id="toggleMode"><i class="fas fa-moon"></i> Dark Mode</button>

  <h1><i class="fas fa-store icon"></i>Super Shop Inventory</h1>

  <section>
    <h2><i class="fas fa-plus-square icon"></i>Add a Product</h2>
    <form id="productForm">
      <input type="number" placeholder="ID" id="id" required>
      <input type="text" placeholder="Name" id="name" required>
      <select id="category">
        <option>BeautyCare</option>
        <option>Vegetables</option>
        <option>Meat</option>
        <option>Groceries</option>
        <option>Others</option>
      </select>
      <input type="number" placeholder="Price" id="price" required>
      <input type="number" placeholder="Quantity" id="quantity" required>
      <input type="date" id="expiryDate">
      <select id="availability">
        <option value="true">Available</option>
        <option value="false">Not Available</option>
      </select>
      <button type="submit"><i class="fas fa-plus icon"></i>Add Product</button>
    </form>
  </section>

  <section>
    <h2><i class="fas fa-edit icon"></i>Update Product</h2>
    <form id="updateForm">
      <input type="number" placeholder="ID" id="updateId" required>
      <input type="text" placeholder="Name" id="updateName" required>
      <select id="updateCategory">
        <option>BeautyCare</option>
        <option>Vegetables</option>
        <option>Meat</option>
        <option>Groceries</option>
        <option>Others</option>
      </select>
      <input type="number" placeholder="Price" id="updatePrice" required>
      <input type="number" placeholder="Quantity" id="updateQuantity" required>
      <input type="date" id="updateExpiryDate">
      <select id="updateAvailability">
        <option value="true">Available</option>
        <option value="false">Not Available</option>
      </select>
      <button type="submit"><i class="fas fa-save icon"></i>Update Product</button>
    </form>
  </section>

  <section>
    <h2><i class="fas fa-database icon"></i>All Products</h2>
    <button onclick="fetchAllProducts()"><i class="fas fa-table icon"></i>Load All</button>
    <table id="allTable"></table>
  </section>

  <section>
    <h2><i class="fas fa-search icon"></i>Get Product By ID</h2>
    <input type="number" id="getId" placeholder="Enter ID">
    <button onclick="fetchById()"><i class="fas fa-search icon"></i>Get Product</button>
    <table id="idTable"></table>
  </section>

  <section>
    <h2><i class="fas fa-filter icon"></i>Products by Category</h2>
    <select id="getCategory">
      <option>BeautyCare</option>
      <option>Vegetables</option>
      <option>Meat</option>
      <option>Groceries</option>
      <option>Others</option>
    </select>
    <button onclick="fetchByCategory()"><i class="fas fa-filter icon"></i>Load By Category</button>
    <table id="categoryTable"></table>
  </section>

  <section>
    <h2><i class="fas fa-check-circle icon"></i>Available Products</h2>
    <button onclick="fetchAvailable()"><i class="fas fa-check icon"></i>Load Available</button>
    <table id="availableTable"></table>
  </section>

  <section>
    <h2><i class="fas fa-hourglass-half icon"></i>Expiring Soon (7 Days)</h2>
    <button onclick="fetchExpiring()"><i class="fas fa-clock icon"></i>Load Expiring</button>
    <table id="expiringTable"></table>
  </section>

  <section>
    <h2><i class="fas fa-tags icon"></i>Discounted Products by Category</h2>
    <form id="discountForm">
      <select id="discountCategory">
        <option>BeautyCare</option>
        <option>Vegetables</option>
        <option>Meat</option>
        <option>Groceries</option>
        <option>Others</option>
      </select>
      <input type="number" placeholder="Discount Rate ( 0.2 = 20% )" id="discountValue" min="0.01" max="0.99" step="100" required>
      <button type="submit"><i class="fas fa-percent icon"></i>Get Discounted</button>
    </form>
    <table id="discountTable"></table>
  </section>

  <section>
    <h2><i class="fas fa-chart-bar icon"></i>Total Value by Category</h2>
    <button onclick="fetchTotalValue()"><i class="fas fa-coins icon"></i>Load Value Report</button>
    <table id="totalValueTable"></table>
  </section>

  <section>
    <h2><i class="fas fa-trash-alt icon"></i>Delete Product</h2>
    <input type="number" id="deleteId" placeholder="Enter ID to Delete">
    <button onclick="deleteProduct()"><i class="fas fa-trash icon"></i>Delete</button>
  </section>

<script>
  const toggleBtn = document.getElementById('toggleMode');
    toggleBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      toggleBtn.innerHTML = document.body.classList.contains('dark-mode') ?
        '<i class="fas fa-sun"></i> Light Mode' :
        '<i class="fas fa-moon"></i> Dark Mode';
    });

const api = 'http://localhost:8080/product'; 


document.getElementById('productForm').onsubmit = async function(e) {
  e.preventDefault();
  const product = {
    id: parseInt(document.getElementById('id').value),
    name: document.getElementById('name').value,
    category: document.getElementById('category').value,
    price: parseFloat(document.getElementById('price').value),
    quantity: parseInt(document.getElementById('quantity').value),
    expiryDate: document.getElementById('expiryDate').value || null,
    available: document.getElementById('availability').value === 'true'
  };
  await fetch(`${api}/add`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(product)
  });
  alert('Product added!');
  document.getElementById('productForm').reset();
};


document.getElementById('updateForm').onsubmit = async function(e) {
  e.preventDefault();
  const product = {
    id: parseInt(document.getElementById('updateId').value),
    name: document.getElementById('updateName').value,
    category: document.getElementById('updateCategory').value,
    price: parseFloat(document.getElementById('updatePrice').value),
    quantity: parseInt(document.getElementById('updateQuantity').value),
    expiryDate: document.getElementById('updateExpiryDate').value || null,
    available: document.getElementById('updateAvailability').value === 'true'
  };
  await fetch(`${api}/update`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(product)
  });
  alert('Product updated!');
  document.getElementById('updateForm').reset();
};


async function fetchAllProducts() {
  const res = await fetch(`${api}/all`);
  const data = await res.json();
  renderTable('allTable', data);
}


async function fetchById() {
  const id = document.getElementById('getId').value;
  const res = await fetch(`${api}/${id}`);
  const data = await res.json();
  renderTable('idTable', [data]);
}


async function fetchByCategory() {
  const category = document.getElementById('getCategory').value;
  const res = await fetch(`${api}/category/${category}`);
  const data = await res.json();
  renderTable('categoryTable', data);
}


async function fetchAvailable() {
  const res = await fetch(`${api}/available`);
  const data = await res.json();
  renderTable('availableTable', data);
}


async function fetchExpiring() {
  const res = await fetch(`${api}/expiring`);
  const data = await res.json();
  renderTable('expiringTable', data);
}


document.getElementById('discountForm').onsubmit = async function(e) {
  e.preventDefault();
  const category = document.getElementById('discountCategory').value;
  const rate = parseFloat(document.getElementById('discountValue').value);
  const res = await fetch(`${api}/discount?category=${category}&rate=${rate}`);
  const data = await res.json();
  renderDiscountTable('discountTable', data, rate);
};


async function fetchTotalValue() {
  const res = await fetch(`${api}/report/total-value`);
  const data = await res.json();
  renderTotalValueTable('totalValueTable', data);
}


async function deleteProduct() {
  const id = document.getElementById('deleteId').value;
  await fetch(`${api}/delete/${id}`, { method: 'DELETE' });
  alert('Product deleted!');
}


function renderTable(tableId, data) {
  let html = '<tr><th>ID</th><th>Name</th><th>Category</th><th>Price</th><th>Qty</th><th>Expiry</th><th>Available</th></tr>';
  data.forEach(p => {
    html += `<tr>
      <td>${p.id}</td>
      <td>${p.name}</td>
      <td>${p.category}</td>
      <td>${p.price.toFixed(2)}</td>
      <td>${p.quantity}</td>
      <td>${p.expiryDate ? p.expiryDate : '—'}</td>
      <td>${p.available ? 'Yes' : 'No'}</td>
    </tr>`;
  });
  document.getElementById(tableId).innerHTML = html;
}


function renderDiscountTable(tableId, data, discountRate) {
  let html = '<tr><th>ID</th><th>Name</th><th>Category</th><th>Original Price</th><th>Discounted Price</th><th>Qty</th><th>Expiry</th><th>Available</th></tr>';
  data.forEach(p => {
    const discountedPrice = p.price.toFixed(2);
    const originalPrice = (p.price / (1 - discountRate)).toFixed(2);
    html += `<tr>
      <td>${p.id}</td>
      <td>${p.name}</td>
      <td>${p.category}</td>
      <td>${originalPrice}</td>
      <td>${discountedPrice}</td>
      <td>${p.quantity}</td>
      <td>${p.expiryDate ? p.expiryDate : '—'}</td>
      <td>${p.available ? 'Yes' : 'No'}</td>
    </tr>`;
  });
  document.getElementById(tableId).innerHTML = html;
}


function renderTotalValueTable(tableId, data) {
  let html = '<tr><th>Category</th><th>Total Value</th></tr>';
  for (const [category, value] of Object.entries(data)) {
    html += `<tr>
      <td>${category}</td>
      <td>${value.toFixed(2)}</td>
    </tr>`;
  }
  document.getElementById(tableId).innerHTML = html;
}
</script>

</body>
</html>
